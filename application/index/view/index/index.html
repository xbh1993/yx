{include file="public:header"}
<script src="https://webapi.amap.com/js/marker.js"></script>
<script src="https://webapi.amap.com/maps?v=1.4.2&key=270729cb85d57dc2fc4a9daf217fee20"></script>
<script type="text/javascript" src="https://webapi.amap.com/demos/js/liteToolbar.js"></script>

<script language="Javascript" type="text/Javascript" src="/static/jquery-3.3.1.min.js"></script>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=0">
<style type="text/css">
    #lunbo img{width: 100%;margin-top: 100px;}
    #lunbo img:not(:first-child){display: none;}
</style>
<div id="lunbo">
    {if condition="isset($bannerinfo) && !empty($bannerinfo)"}
    {volist name="$bannerinfo" id='item'}
    <img src="{$item|default=''}">
    {/volist}
    {/if}
</div>

<!--关于扬翔-->
<div class="onyx">
    <div class="tb">
        <div class="onyx_text">About Yang Xiang</div>
        <div class="onyx_text">关于扬翔</div>
    </div>
    <div class="onyx_content">
        <div class="onyx_detail">
            <div class="onyx_tit">Guang xi &nbsp;yang xiang &nbsp;co . &nbsp;LTD .</div>
            <div class="onyx_name">广 西 扬 翔 股 份 有 限 公 司</div>
            <div class="onyx_em">{$profile['text']}</div>
            <a href="/index/into/into.html">
                <div class="onyx_more">点击了解更多</div>
            </a>
        </div>
        <img class="onyx_img" src="/static/index/images/3.jpg">
    </div>
</div>
<!--扬翔分公司分布-->
<div class="buted">
    <div class="tb" style="background: #f2f3f5;">
        <div class="onyx_text">Branch &nbsp;distri bution</div>
        <div class="onyx_text">扬翔分公司分布</div>
    </div>
    <div class="buteda">
        <div id="Tabfen" style="background: #f2f3f5;">
            <div class="tabfenItemContainer">
                <li data-type="1"><a class="tabfenItemCurrent">饲料分公司</a></li>
                <li data-type="2"><a>养猪分公司</a></li>
            </div>
            <div class="tabfenBodyContainer">
                <div class="tabfenBodyItem tabfenBodyCurrent">
                    <div class="map" id="container">

                    </div>
                </div>
                <div class="tabfenBodyItem">

                </div>
            </div>
        </div>

    </div>
</div>
<!--国际合作-->
<div class="onyx">
    <div class="tb">
        <div class="onyx_text">International cooperation</div>
        <div class="onyx_text">国际合作</div>
    </div>
    <div class="onyx_content">
        <img class="onyx_img" src="{$newslist.thumb}">
        <div class="onyx_detail">
            <div class="onyx_name" style="margin-top: 20px;">{$newslist.title}</div>
            <div class="onyx_em">{$newslist.introduction}</div>
            <a href="/index/details/international.html">
                <div class="onyx_more"> 点击了解更多</div>
            </a>
        </div>
    </div>
</div>
<!--产品介绍-->
<div class="buted" style="background: #f2f3f5;">
    <div class="tb">
        <div class="onyx_text">Proguct introduction</div>
        <div class="onyx_text">产品介绍</div>
    </div>
    <div class="goodsb">
        {volist name="productlist" id="vo"}
        <div class="goodsl">
            <img src="{$vo.thumb}">
            <div class="gooodslbtm">
                <div class="jies">{$vo.title}</div>
                <div class="goods_span">{$vo.introduction}</div>
            </div>
        </div>
        {/volist}
    </div>
</div>
<!--新闻中心-->
<div class="onyx">
    <div class="tb">
        <div class="onyx_text">News Center</div>
        <div class="onyx_text">新闻中心</div>
    </div>
    <div class="newb">
        <div class="newl">
            <div class="newl_name">扬翔新闻</div>
            <img src="{$news1.thumb}">
            <div class="newtext">{$news1.title}</div>
            <div class="new_span">{$news1.introduction}</div>
        </div>
        <div class="newl">
            <div class="newl_name">扬翔视频</div>
            <img src="{$video.image}">
            <div class="newtext">{$video.title}</div>
            <div class="new_span">{$video.describe}</div>
        </div>
        <div class="newl">
            <div class="newl_name">媒体报道</div>
            <img src="{$news2.thumb}">
            <div class="newtext">{$news2.title}</div>
            <div class="new_span">{$news2.introduction}</div>
        </div>
    </div>
</div>

<script language="Javascript" type="text/Javascript" src="/static/index/js/feed.js"></script>
<script>

    var map = new AMap.Map('container', {resizeEnable: true, zoom: 5,zoomEnable:false,});
    var infoWindow = new AMap.InfoWindow({offset: new AMap.Pixel(0, -30)});
    var markers = [];
    var url="{:url('index/index/getCompanyList')}"
    $.post(url,{type:1},function (res) {
       if(res.code==1){
           getmap(res.data)
       }
    },'json')

   $('.tabfenItemContainer li').click(function () {
       $('.tabfenItemContainer li a').removeClass('tabfenItemCurrent');
         $(this).find('a').addClass('tabfenItemCurrent');
           var type= $(this).attr('data-type');
          $.post(url,{type:type},function (res) {
           if(res.code==1){
               map.remove(markers);
               getmap(res.data)
           }
       },'json')
   })


    function getmap(data) {
        markers=[];
        for (var i = 0, marker; i < data.length; i++) {
            var position=data[i].location.split(',');

            var html = ' <div class="map_com">\n' +
                '                                    <div class="map_left">\n' +
                '                                        <div class="map_name">'+data[i].title+'</div>\n' +
                '                                        <div class="map_xia"></div>\n' +
                '                                        <div class="map_jianjie">'+data[i].describle+'</div>'+
                '                                        <div class="map_address">地址:'+data[i].address+'</div>\n' +
                '                                        <div class="map_phone">\n' +
                '                                            <div class="phone_text">联系电话：'+data[i].tel+'</div>\n' +
                '                                            <img src="/static/index/images/phonef.png">\n' +
                '                                        </div>\n' +
                '                                    </div>\n' +
                '                                    <img src="'+data[i].image+'">\n' +
                '                                </div>';

            var marker = new AMap.Marker({
                position: [position[1],position[0]],
                map: map
            });

            marker.content = html;
            markers.push(marker);
            marker.on('click', markerClick);
        }
        map.setFitView();
        map.setZoomAndCenter(4, [104.205467, 39.857761]);
        //    map.setLimitBounds(map.getBounds());
    }




    function markerClick(e) {
        infoWindow.setContent(e.target.content);
        infoWindow.open(map, e.target.getPosition());
    }


    //轮播图
    //因为使用了document，所以js需要放在需要执行的代码下面生效才能生效
    var img=document.getElementById('lunbo').getElementsByTagName("img");
    var num=0;
    var len=img.length;

    setInterval(function(){
        img[num].style.display="none";
        num=++num==len?0:num;
        img[num].style.display="inline-block";

    },3000);//切换时间
</script>

{include file="public:foot"}